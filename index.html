<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/main.css">

    <link href="https://fonts.googleapis.com/css2?family=Dosis&family=Montserrat:wght@300&display=swap" rel="stylesheet">
    <title>Encriptdor de Texto</title>
</head>

<body>
    <header>
        <nav class="barra-navegacion">
            <ul class="botones-navegacion">
                <li class="logo-encriptador">
                    <img src="assets/logo-encriptador.png" alt="Logo de encriptador">
                    <p class="nombre-encriptador">EncriptCode</p>
                </li>
                <li class="logo-alura">
                    <img src="assets/logo-alura.png" alt="Logo de alura">
                </li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="fila-contenedor">
            <div id="contenedorTextoInput">
                <div class="barra-textoInput">
                    <textarea name="texto-insertado" id="input-texto" placeholder="Ingrese el texto..."></textarea>
                </div>

                <div class="botones-accion">
                    <button onclick="encriptarTexto()" class="btn-encriptar">Encriptar</button>
                    <button onclick="desencriptarTexto()" class="btn-desencriptar">Desencriptar</button>
                </div>
            </div>

            <div class="barra-historial">
                <div id="contenedorTextoTratado">
                    <textarea name="textoTratado" onclick="bloquearTextArea()" id="textoTratado" placeholder="..."></textarea>
                    <button onclick="copiarTexto()" id="copiarTexto">Copiar</button>
                </div>
                
                <div id="contenedorTextoInicial">
                    <img class="personaje-encriptador" src="assets/personaje-encriptador.png"
                        alt="Personaje del Encriptador">
                    <div class="texto-historial">
                        <p class="titulo-Inicial">Ningun mensaje fue encontrado</p>
                        <p class="indicaciones-iniciales">Ingrese el texto que desee encriptar o desencriptar</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="pie-pagina">
        <p>Elaborado por Snake-13</p>
    </footer>

    <script>
        //BLOQUEAR TEXT AREA QUE MUESTRA EL TEXTO ENCRIPTADO O DESENCRIPTADO
        function bloquearTextArea(){
            const AreaTextoTratado = document.getElementById("textoTratado");
            AreaTextoTratado.readOnly = true;
        }
    </script>

    <script>
        //REMOVER MAYUSCULAS, CARACTERES ACENTUADOS Y ESPECIALES
        function romoverCaracteresEspeciales(textoAcondicionado){
            textoAcondicionado = textoAcondicionado.normalize("NFD").replace(/[\u0300-\u036f]/g,"");
            textoAcondicionado = textoAcondicionado.replace(/[^a-z0-9\s]/g, "");
            return textoAcondicionado;
        }
    </script>

    <script>
        //COLOCAR EL PUNTERO EN EL INPUT
        let inputTexto = document.getElementById("input-texto");
        let contenedorTextoInput = document.getElementById("contenedorTextoInput");

        contenedorTextoInput.addEventListener('click', function () {
            inputTexto.focus();
        });

        inputTexto.addEventListener("input", function(event){
            let textoInputUsuario = event.target.value;
            let textoSinCaracteresEspeciales = romoverCaracteresEspeciales(textoInputUsuario);
            event.target.value = textoSinCaracteresEspeciales;
        });
    </script>

    <script>

        const claveEncriptacion = {
            e: "enter",
            i: "imes",
            a: "ai",
            o: "ober",
            u: "ufat"
        };

        function revisarTextoInput(){
            let textoIngresado = document.getElementById("input-texto");
            if(textoIngresado.value.trim() == ""){
                alert("El campo no puede estar vacio, intente de nuevo");
                return false;
            }
            return true;
        }

        function colocarTexto(textoTratado){
            let contenedorTextoInput = document.getElementById("contenedorTextoInicial");
            let contenedorTextoTratado = document.getElementById("contenedorTextoTratado");
            let textAreaEncriptado = document.getElementById("textoTratado");

            contenedorTextoInput.style.display = "none";
            contenedorTextoTratado.style.display = "flex";
            textAreaEncriptado.value = textoTratado;
        }

        function encriptarTexto(){
            if(!revisarTextoInput()){
                return 0;
            }

            let textoSinEncriptar = document.getElementById("input-texto");
            let textoEncriptado = textoSinEncriptar.value;
            textoSinEncriptar.value = "";
            
            let objEncriptacion = Object.entries(claveEncriptacion);

            for(let [claveObj, valorObj] of objEncriptacion){
                textoEncriptado = textoEncriptado.replace(new RegExp(claveObj, "g"), valorObj); 
            }

            colocarTexto(textoEncriptado);
        }

        function desencriptarTexto(){
            if(!revisarTextoInput()){
                return 0;
            }

            let textoEncriptado = document.getElementById("input-texto");
            let textoDesencriptado = textoEncriptado.value;
            textoEncriptado.value = "";
            
            let objEncriptacion = Object.entries(claveEncriptacion);

            for(let [claveObj, valorObj] of objEncriptacion){
                textoDesencriptado = textoDesencriptado.replace(new RegExp(valorObj, "g"), claveObj); 
            }

            colocarTexto(textoDesencriptado);
        }
    </script>

    <script>
        function copiarTexto(){
            const TextAreaTratado = document.getElementById("textoTratado");
            const TextAreaUsuario = document.getElementById("input-texto");

            TextAreaTratado.select();
            document.execCommand("copy");
            TextAreaTratado.setSelectionRange(0,0);
            alert("Texto copiado");
            TextAreaUsuario.focus();
        }
    </script>
</body>

</html>